<%- include('../partials/header.ejs') %> <%-
include('../partials/page_header.ejs') %>

<style>
  .btn {
    padding: 0.25rem 0.5rem; /* Adjust padding to decrease button size */
    font-size: 0.875rem; /* Adjust font size for smaller buttons */
    border-style: none;
    margin: 2px;
  }

  .btn-warning {
    background-color: yellow;
    color: black; /* Optional: Set text color */
  }

  /* Styling for btn-danger (red background) */
  .btn-danger {
    background-color: red;
    color: white; /* Optional: Set text color */
  }

  .btn-warning:hover {
    background-color: #ffea00; /* Darker yellow on hover */
  }

  .btn-danger:hover {
    background-color: #d32f2f; /* Darker red on hover */
  }
</style>

<main class="main d-flex" style="flex-direction: column">
  <!-- breadcrumbs -->
  <div class="page-header breadcrumb-wrap pb-5 pt-5">
    <div class="container">
      <div class="breadcrumb" style="height: 10px">
        <a href="/" rel="nofollow">Home</a>
        <span>Account</span>
      </div>
    </div>
  </div>

  <!-- side menu -->
  <div>
    <div class="row">
      <div>
        <div class="dashboard-menu">
          <ul
            class="nav text-center"
            style="justify-content: center"
            role="tablist"
          >
            <li class="nav-item text-center">
              <a
                class="nav-link"
                id="account-detail-tab"
                href="/my_profile"
                ><i class="fi-rs-user mr-10 text-center"></i>Account details</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" id="account-detail-tab" href="/my_address"
                ><i class="fi-rs-marker mr-10"></i>My Address</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" id="account-detail-tab" href="/my_orders"
                style="background-color: black; color: white"
                ><i class="fi-rs-shopping-bag mr-10"></i>Orders</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" id="account-detail-tab" href="/my_wallet"
                ><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" fillRule="evenodd" d="M20 9c1.1 0 2 .9 2 2v2c0 1.1-.9 2-2 2v3a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2zm-2 0V6H4v12h14v-3h-2c-1.1 0-2-1.1-2-2v-1.968C14 9.9 14.9 9 16 9zm-2 4h2v-2h-2z"></path></svg></i>Wallet</a
              >
            </li>

            <li class="nav-item">
              <a class="nav-link" class="nav-link" href="/logout"
                ><i class="fi-rs-sign-out mr-10"></i>Logout</a
              >
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <section class="pt-30 pb-30" style="height: 800px">
    <div class="container">
      <div class="col-lg-12 m-auto">
        <div class="card">
                        <div class="card-header text-center">
                          <h5 class="mb-0 ">Your Order History</h5>
                        </div>
                        <div class="card-body">
                          <div class="table-responsive">
                            <% if(orders.length !== 0) { %>
                              
                            <table class="table text-center">
                              <thead>
                                <tr>
                                  <th>Order ID</th>
                                  <th>Products</th>
                                  <th>Purchase Date</th>
                                  <th>Status</th>
                                  <!-- <th>Total</th> -->
                                  <th>Actions</th>
                                </tr>
                              </thead>
                              <tbody>
                                <% for(let i=0; i<orders.length; i++) { %>
                                <tr>
                                  <td><%= orders[i].orderId %></td>
                                  <td>
                                    <ul class="text-start">
                                      <% let k = 1 %>
                                      <% orders[i].products.forEach(element => { %>
                                      <li><%= k %>.<%= element.productName %></li>
                                      <% k++ %>
                                     <% }); %>
                                    </ul>
                                  </td>
                                  <td><%= orders[i].showDate %></td>
                                  <td><%= orders[i].orderStatus %></td>
                                  <td>
                                    <ul>
                                      <% if(orders[i].orderStatus === "delivered") { %>
                                        <li><button class="btn btn-danger">Return Product</button></li>
                                        <% } else { %>
                                          <li><button class="btn btn-warning">Cancel Order</button></li>
                                          <% } %>
                                    </ul>
                                    <a href="#" class="btn"
                                      >View Details</a
                                    >
                                  </td>
                                </tr>
                                <% } %>
                              </tbody>
                            </table> 
                                <% } else { %>
                                  <h1>Nothing ordered yet...</h1>
                                  <% } %>
                          </div>
                        </div>
                      </div>
      </div>
    </div>
  </section>
</main>

<script>
// Helper function to format date and time as "hours:minutes day-month-year"
function formatDateTime(date) {
  const hours = date.getHours().toString().padStart(2, '0');
  const minutes = date.getMinutes().toString().padStart(2, '0');
  const day = date.getDate();
  const monthIndex = date.getMonth();
  const year = date.getFullYear();

  const months = [
    'January', 'February', 'March', 'April', 'May', 'June',
    'July', 'August', 'September', 'October', 'November', 'December'
  ];

  const month = months[monthIndex];

  return `${hours}:${minutes} ${day}-${month}-${year}`;
}
</script>

<%- include('../partials/page_footer.ejs') %> <%-
include('../partials/footer.ejs')%>
